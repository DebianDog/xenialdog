#!/bin/bash

opt1=" Rox pinboard"
opt2=" Tint2 Panels"
opt3=" Pcmanfm + Lxpanel"
opt1a="Desktop provided by rox pinboard, tint2 bottom panel"
opt2a="Tint2 bottom and top panel"
opt3a="Desktop provided by pcmanfm, lxpanel bottom panel"

cmd=$1

cd $HOME/.config/openbox


roxd() {
kill $pdyad
ln -sf rox-pinbd set-desktop

cd --
pidpcman="`ps -eo pid,cmd | grep -v grep | grep "pcmanfm --desktop" | awk '{ print $1 }'`"
#[ "$pidpcman" ] && kill $pidpcman
pcmanfm --desktop-off 2> /dev/null
pidlxpanel="`ps -eo pid,cmd | grep -v grep | grep "lxpanel" | awk '{ print $1 }'`"
[ "$pidlxpanel" ] && kill $pidlxpanel
pidwbar="`ps -eo pid,cmd | grep -v grep | grep "cairo-dock" | awk '{ print $1 }'`"
kill $pidwbar 2> /dev/null
killall compton 2> /dev/null
sleep 1

pidtint1="`ps -eo pid,cmd | grep -v grep | grep "tint2 -c $HOME/.config/tint2/tint2rcl" | awk '{ print $1 }'`"
kill $pidtint1 2> /dev/null
setbackdrop &
pidrox="`ps -eo pid,cmd | grep -v grep | grep "rox -p ${HOME}/.config/rox.sourceforge.net/ROX-Filer/pinbd-OB" | awk '{ print $1 }'`"
[ -z "$pidrox" ] && /usr/bin/rox -p ${HOME}/.config/rox.sourceforge.net/ROX-Filer/pinbd-OB &
pidtint="`ps -eo pid,cmd | grep -v grep | grep "tint2" | grep -v ".config" | awk '{ print $1 }'`"
pidtint2="`ps -eo pid,cmd | grep -v grep | grep "tint2 -c $HOME/.config/tint2/tint2rcs" | awk '{ print $1 }'`"
kill $pidtint2 2> /dev/null 
[ -z "$pidtint" ] && tint2 &
}
export -f roxd


tintd() {
kill $pdyad
ln -sf tint2p set-desktop

cd --
pidpcman="`ps -eo pid,cmd | grep -v grep | grep "pcmanfm --desktop" | awk '{ print $1 }'`"
#[ "$pidpcman" ] && kill $pidpcman
pcmanfm --desktop-off 2> /dev/null
pidlxpanel="`ps -eo pid,cmd | grep -v grep | grep "lxpanel" | awk '{ print $1 }'`"
[ "$pidlxpanel" ] && kill $pidlxpanel
pidwbar="`ps -eo pid,cmd | grep -v grep | grep "cairo-dock" | awk '{ print $1 }'`"
kill $pidwbar 2> /dev/null
sleep 1
pidrox="`ps -eo pid,cmd | grep -v grep | grep "rox -p ${HOME}/.config/rox.sourceforge.net/ROX-Filer/pinbd-OB" | awk '{ print $1 }'`"
kill $pidrox 2> /dev/null
killall setbackdrop
nitrogen --restore &
sleep 2

killall compton 2> /dev/null

pidtint2="`ps -eo pid,cmd | grep -v grep | grep "tint2 -c $HOME/.config/tint2/tint2rcs" | awk '{ print $1 }'`"
kill $pidtint2 2> /dev/null
pidtint1="`ps -eo pid,cmd | grep -v grep | grep "tint2" | grep -v ".config" | awk '{ print $1 }'`"
[ -z "$pidtint1" ] && tint2 &
pidtint="`ps -eo pid,cmd | grep -v grep | grep "tint2 -c $HOME/.config/tint2/tint2rcl" | awk '{ print $1 }'`"
[ -z "$pidtint" ] && tint2 -c $HOME/.config/tint2/tint2rcl &
}
export -f tintd

pcmand() {
kill $pdyad
ln -sf pcman set-desktop

cd --
pidwbar="`ps -eo pid,cmd | grep -v grep | grep "cairo-dock" | awk '{ print $1 }'`"
kill $pidwbar 2> /dev/null
sleep 1
pidrox="`ps -eo pid,cmd | grep -v grep | grep "rox -p ${HOME}/.config/rox.sourceforge.net/ROX-Filer/pinbd-OB" | awk '{ print $1 }'`"
kill $pidrox 2> /dev/null
killall setbackdrop
#nitrogen --restore &

sleep 2

killall compton 2> /dev/null

#pidtint2="`ps -eo pid,cmd | grep -v grep | grep "tint2 -c $HOME/.config/tint2/tint2rcs" | awk '{ print $1 }'`"
#kill $pidtint2 2> /dev/null
#pidtint1="`ps -eo pid,cmd | grep -v grep | grep "tint2" | grep -v ".config" | awk '{ print $1 }'`"
#[ -z "$pidtint1" ] && tint2 &
#pidtint="`ps -eo pid,cmd | grep -v grep | grep "tint2 -c $HOME/.config/tint2/tint2rcl" | awk '{ print $1 }'`"
#[ -z "$pidtint" ] && tint2 -c $HOME/.config/tint2/tint2rcl &
killall tint2
sleep 1
pcmanfm --desktop &

lxpanel &
}
export -f pcmand

if [ -z "$cmd" ]; then
yad --icons --center --read-dir=/usr/local/obdesktop --image=user-desktop --window-icon=user-desktop --image-on-top --title="Desktop Manager" --height=540 --width=670 --text=" <b> Select Desktop Mode (Openbox only) </b>  \n Choose one of the options (double-click). " --no-buttons --item-width=300


fi

export pdyad="`ps -eo pid,cmd | grep -v grep | grep "yad --icons --center --read-dir=/usr/local/obdesktop" | awk '{ print $1 }'`"


if [ "$cmd" = "roxd" ]; then
roxd &
disown
fi

if [ "$cmd" = "tintd" ]; then
tintd &
disown
fi

if [ "$cmd" = "pcmand" ]; then
pcmand &
disown
fi

exit 0









